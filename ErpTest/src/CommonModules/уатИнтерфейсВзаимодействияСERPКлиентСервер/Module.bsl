
////////////////////////////////////////////////////////////////////////////////
// Интерфейс взаимодействия с общими модулями конфигурации ERP.
//
// Клиент-серверные методы.
//  
////////////////////////////////////////////////////////////////////////////////

#Область СлужебныеПроцедурыИФункции

Процедура уатУстановитьСвойствоЭлементаФормы(ЭлементыФормы, ИмяЭлемента, ИмяСвойства, Значение, УстанавливатьДляПодчиненных = Ложь) Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульОбщегоНазначенияУТКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("ОбщегоНазначенияУТКлиентСервер");
		Исключение
			МодульОбщегоНазначенияУТКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульОбщегоНазначенияУТКлиентСервер = ОбщегоНазначения.ОбщийМодуль("ОбщегоНазначенияУТКлиентСервер");
		Исключение
			МодульОбщегоНазначенияУТКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если Не МодульОбщегоНазначенияУТКлиентСервер = Неопределено Тогда
		МодульОбщегоНазначенияУТКлиентСервер.УстановитьСвойствоЭлементаФормы(ЭлементыФормы, ИмяЭлемента,
			ИмяСвойства, Значение, УстанавливатьДляПодчиненных);
	КонецЕсли;
	
КонецПроцедуры

Процедура уатИзменитьЭлементОтбораГруппыСписка(Группа, ИмяПоля, ПравоеЗначение = Неопределено, Установить = Ложь, ВидСравнения = Неопределено) Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульОтборыСписковКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("ОтборыСписковКлиентСервер");
		Исключение
			МодульОтборыСписковКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульОтборыСписковКлиентСервер = ОбщегоНазначения.ОбщийМодуль("ОтборыСписковКлиентСервер");
		Исключение
			МодульОтборыСписковКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если Не МодульОтборыСписковКлиентСервер = Неопределено Тогда
		МодульОтборыСписковКлиентСервер.ИзменитьЭлементОтбораГруппыСписка(Группа, ИмяПоля, ПравоеЗначение, Установить, ВидСравнения);
	КонецЕсли;
	
КонецПроцедуры

Функция уатСоздатьГруппуЭлементовОтбора(КоллекцияЭлементов, Представление, ТипГруппы) Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульОтборыСписковКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("ОтборыСписковКлиентСервер");
		Исключение
			МодульОтборыСписковКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульОтборыСписковКлиентСервер = ОбщегоНазначения.ОбщийМодуль("ОтборыСписковКлиентСервер");
		Исключение
			МодульОтборыСписковКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если МодульОтборыСписковКлиентСервер = Неопределено Тогда
		Возврат Неопределено;
	Иначе 
		Возврат МодульОтборыСписковКлиентСервер.СоздатьГруппуЭлементовОтбора(КоллекцияЭлементов, Представление, ТипГруппы);
	КонецЕсли;
	
КонецФункции

Процедура уатУстановитьЭлементОтбораСписка(Список, ИмяПоля, ПравоеЗначение, ВидСравнения = Неопределено, Представление = "") Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульОтборыСписковКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("ОтборыСписковКлиентСервер");
		Исключение
			МодульОтборыСписковКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульОтборыСписковКлиентСервер = ОбщегоНазначения.ОбщийМодуль("ОтборыСписковКлиентСервер");
		Исключение
			МодульОтборыСписковКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если Не МодульОтборыСписковКлиентСервер = Неопределено Тогда
		МодульОтборыСписковКлиентСервер.УстановитьЭлементОтбораСписка(Список, ИмяПоля, ПравоеЗначение, ВидСравнения, Представление);
	КонецЕсли;
	
КонецПроцедуры

Процедура уатАвтоПодбор(Элемент, Текст, ДанныеВыбора, Ожидание, СтандартнаяОбработка) Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульСпискиВыбораКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("СпискиВыбораКлиентСервер");
		Исключение
			МодульСпискиВыбораКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульСпискиВыбораКлиентСервер = ОбщегоНазначения.ОбщийМодуль("СпискиВыбораКлиентСервер");
		Исключение
			МодульСпискиВыбораКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если Не МодульСпискиВыбораКлиентСервер = Неопределено Тогда
		МодульСпискиВыбораКлиентСервер.АвтоПодбор(Элемент, Текст, ДанныеВыбора, Ожидание, СтандартнаяОбработка);
	КонецЕсли;
	
КонецПроцедуры

Процедура уатЗагрузить(ИмяНастройки, СписокВыбора)Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульСпискиВыбораКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("СпискиВыбораКлиентСервер");
		Исключение
			МодульСпискиВыбораКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульСпискиВыбораКлиентСервер = ОбщегоНазначения.ОбщийМодуль("СпискиВыбораКлиентСервер");
		Исключение
			МодульСпискиВыбораКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если Не МодульСпискиВыбораКлиентСервер = Неопределено Тогда
		МодульСпискиВыбораКлиентСервер.Загрузить(ИмяНастройки, СписокВыбора);
	КонецЕсли;
	
КонецПроцедуры

Процедура уатОбновитьСписокВыбора(СписокВыбора, СтрокаПоиска, РазмерСпискаВыбора = 1000) Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульСпискиВыбораКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("СпискиВыбораКлиентСервер");
		Исключение
			МодульСпискиВыбораКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульСпискиВыбораКлиентСервер = ОбщегоНазначения.ОбщийМодуль("СпискиВыбораКлиентСервер");
		Исключение
			МодульСпискиВыбораКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если Не МодульСпискиВыбораКлиентСервер = Неопределено Тогда
		МодульСпискиВыбораКлиентСервер.ОбновитьСписокВыбора(СписокВыбора, СтрокаПоиска, РазмерСпискаВыбора);
	КонецЕсли;
	
КонецПроцедуры

Функция уатПолучитьСтруктуруПересчетаСуммыНДСВСтрокеТЧ(Объект) Экспорт
	
	#Если Клиент Тогда
		Попытка
			МодульОбработкаТабличнойЧастиКлиентСервер = ОбщегоНазначенияКлиент.ОбщийМодуль("ОбработкаТабличнойЧастиКлиентСервер");
		Исключение
			МодульОбработкаТабличнойЧастиКлиентСервер = Неопределено;
		КонецПопытки;
	#Иначе
		Попытка
			МодульОбработкаТабличнойЧастиКлиентСервер = ОбщегоНазначения.ОбщийМодуль("ОбработкаТабличнойЧастиКлиентСервер");
		Исключение
			МодульОбработкаТабличнойЧастиКлиентСервер = Неопределено;
		КонецПопытки;
	#КонецЕсли
	
	Если МодульОбработкаТабличнойЧастиКлиентСервер = Неопределено Тогда
		Возврат Новый Структура();
	Иначе 
		Возврат МодульОбработкаТабличнойЧастиКлиентСервер.ПараметрыПересчетаСуммыНДСВСтрокеТЧ(Объект);
	КонецЕсли;
	
КонецФункции

#КонецОбласти
