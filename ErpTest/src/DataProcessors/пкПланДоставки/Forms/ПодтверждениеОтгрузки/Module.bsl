
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
    
    ЗаданияДляПодтверждения = ДанныеФормыВЗначение(Параметры.ЗаданияНаПеревозку, Тип("ТаблицаЗначений"));
    
    ЗаданияНаПеревозку.Загрузить(ЗаданияДляПодтверждения);
    
КонецПроцедуры

&НаКлиенте
Процедура Подтвердить(Команда)
    
    ПодтвердитьНаСервере();
    
    Закрыть();
    
КонецПроцедуры

&НаСервере
Процедура ПодтвердитьНаСервере()
    
    ТекущийПользователь = Пользователи.ТекущийПользователь();
    
    Для Каждого Строка ИЗ ЗаданияНаПеревозку Цикл
        ЗаданиеНаПеревозку = Строка.ЗаданиеНаПеревозку.ПолучитьОбъект();
        
        ЗаданиеНаПеревозку.ОтгрузкаПодтверждена     = Истина;
        ЗаданиеНаПеревозку.КтоПодтвердил            = ТекущийПользователь;
        ЗаданиеНаПеревозку.ОбоснованиеПодтверждения = ОбоснованиеПодтверждения;
        
        Попытка
            ЗаданиеНаПеревозку.Записать(РежимЗаписиДокумента.Проведение);        
        Исключение
        КонецПопытки;
    КонецЦикла; 
        
КонецПроцедуры    

&НаКлиенте
Процедура ПриЗакрытии(ЗавершениеРаботы)
	ОповеститьОВыборе("Ок");
КонецПроцедуры
