
Процедура ПередЗаписью(Отказ)
    
    Если ЭтотОбъект.Номер = "" Тогда
        СформироватьНомер();         
    КонецЕсли;

КонецПроцедуры

Процедура СформироватьНомер()
    
    Запрос = Новый Запрос;
    Запрос.Текст = 
    "ВЫБРАТЬ ПЕРВЫЕ 1
    |	пкДополнительныеСоглашенияКДоговорам.Номер КАК Номер
    |ИЗ
    |	Справочник.пкДополнительныеСоглашенияКДоговорам КАК пкДополнительныеСоглашенияКДоговорам
    |ГДЕ
    |	пкДополнительныеСоглашенияКДоговорам.Владелец = &Владелец
    |
    |УПОРЯДОЧИТЬ ПО
    |	пкДополнительныеСоглашенияКДоговорам.Код УБЫВ";
    
    Запрос.УстановитьПараметр("Владелец", ЭтотОбъект.Владелец);
    
    Результат = Запрос.Выполнить();
    Выборка = Результат.Выбрать();
    
    Если Выборка.Следующий() Тогда
        НомерПозиции 		= СтрНайти(Выборка.Номер, "/");  
		//@skip-warning
		МассивСРазделителем = СтрРазделить(Выборка.Номер,"/");
		Номер = Число(Лев(Выборка.Номер, НомерПозиции - 1)) + 1;
			
        ЭтотОбъект.Номер = Строка(Номер) + "/" + ЭтотОбъект.Владелец.Номер; 
        ЭтотОбъект.Наименование = ЭтотОбъект.Номер;
    Иначе
        ЭтотОбъект.Номер = "1/" + ЭтотОбъект.Владелец.Номер; 
        ЭтотОбъект.Наименование = ЭтотОбъект.Номер;
    КонецЕсли;
    
КонецПроцедуры    


Процедура ОбработкаПроверкиЗаполнения(Отказ, ПроверяемыеРеквизиты)
    
    НепроверяемыеРеквизиты = Новый Массив;
    
    НепроверяемыеРеквизиты.Добавить("Наименование");
    
    ОбщегоНазначения.УдалитьНепроверяемыеРеквизитыИзМассива(ПроверяемыеРеквизиты, НепроверяемыеРеквизиты);

КонецПроцедуры


Процедура ПриКопировании(ОбъектКопирования)
	
	Номер 			= Неопределено;
	Наименование 	= Неопределено;
	
КонецПроцедуры

